(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{48:function(e,t,n){e.exports=n(61)},53:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(42),l=n.n(o),i=(n(53),n(17)),u=n(18),c=n(20),m=n(19),s=n(16),d=n(5),b=n(28),h=n(7),p=n(22),E=n(62),f=n(23);function v(){var e=Object(f.a)(["\n\tmutation($id: ID!) {\n\t\tremoveAuthor(id: $id) {\n\t\t\tname\n\t\t\tid\n\t\t}\n\t}\n"]);return v=function(){return e},e}function k(){var e=Object(f.a)(["\n\tmutation($id: ID!) {\n\t\tremoveBook(id: $id) {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t}\n"]);return k=function(){return e},e}function g(){var e=Object(f.a)(["\n\tmutation($name: String!, $genre: String!, $authorId: ID!) {\n\t\taddBook(name: $name, genre: $genre, authorId: $authorId) {\n\t\t\tname\n\t\t\tid\n\t\t}\n\t}\n"]);return g=function(){return e},e}function y(){var e=Object(f.a)(["\n\tquery($id: ID) {\n\t\tbook(id: $id) {\n\t\t\tid\n\t\t\tname\n\t\t\tgenre\n\t\t\tauthor {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tage\n\t\t\t\tbooks {\n\t\t\t\t\tname\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]);return y=function(){return e},e}function j(){var e=Object(f.a)(["\n\t{\n\t\tauthors {\n\t\t\tname\n\t\t\tid\n\t\t\tbooks {\n\t\t\t\tname\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n"]);return j=function(){return e},e}function O(){var e=Object(f.a)(["\n\t{\n\t\tauthors {\n\t\t\tname\n\t\t\tid\n\t\t}\n\t}\n"]);return O=function(){return e},e}function C(){var e=Object(f.a)(["\n\t{\n\t\tbooks {\n\t\t\tname\n\t\t\tid\n\t\t}\n\t}\n"]);return C=function(){return e},e}var H=Object(s.b)(C()),A=Object(s.b)(O()),B=Object(s.b)(j()),I=Object(s.b)(y()),D=Object(s.b)(g()),N=Object(s.b)(k()),$=Object(s.b)(v()),w=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"displayBookDetails",value:function(){var e=this.props.data,t=e.book,n=e.loading,a=e.error;return n?r.a.createElement("p",null,"Loading book details..."):this.props.bookId&&a?r.a.createElement("p",null,"Error: ",a.message):t?r.a.createElement("div",null,r.a.createElement("h2",null,t.name),r.a.createElement("p",null,t.genre),r.a.createElement("p",null,t.author.name),r.a.createElement("p",null,"All books by this author:"),r.a.createElement("ul",{className:"other-books"},t.author.books.map((function(e){return r.a.createElement("li",{key:e.id},e.name)})))):r.a.createElement("p",null,"No book selected.")}},{key:"render",value:function(){return r.a.createElement("div",{id:"book-details"},this.displayBookDetails())}}]),n}(a.Component),F=Object(E.a)(I,{options:function(e){return{variables:{id:e.bookId}}}})(w),M=n(47),Q=n(32),S=n.n(Q),q=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={name:"",genre:"",authorId:""},a.inputChangeHandler=a.inputChangeHandler.bind(Object(p.a)(a)),a.submitFormHandler=a.submitFormHandler.bind(Object(p.a)(a)),a.resetFieldsHandler=a.resetFieldsHandler.bind(Object(p.a)(a)),a}return Object(u.a)(n,[{key:"displayAuthors",value:function(){var e=this.props.getAuthorsQuery,t=e.loading,n=e.authors;return t?r.a.createElement("option",null,"loading authors..."):n?n.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)})):void 0}},{key:"inputChangeHandler",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState(Object(M.a)({},a,n))}},{key:"resetFieldsHandler",value:function(){this.setState({name:"",genre:"",authorId:""})}},{key:"submitFormHandler",value:function(e){var t=this;e.preventDefault();var n=this.state,a=n.name,r=n.genre,o=n.authorId;this.props.addBookMutation({variables:{name:a,genre:r,authorId:o},refetchQueries:[{query:H}]}).then((function(e){t.resetFieldsHandler()})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){return r.a.createElement("form",{id:"add-book",onSubmit:this.submitFormHandler},r.a.createElement("div",{className:"field"},r.a.createElement("label",null,"Book name:"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.inputChangeHandler})),r.a.createElement("div",{className:"field"},r.a.createElement("label",null,"Genre:"),r.a.createElement("input",{type:"text",name:"genre",value:this.state.genre,onChange:this.inputChangeHandler})),r.a.createElement("div",{className:"field"},r.a.createElement("label",null,"Author:"),r.a.createElement("select",{name:"authorId",onChange:this.inputChangeHandler,value:this.state.authorId},r.a.createElement("option",{value:""},"Select author"),this.displayAuthors())),r.a.createElement("button",{type:"submit"},"+"))}}]),n}(a.Component),x=S()(Object(E.a)(A,{name:"getAuthorsQuery"}),Object(E.a)(D,{name:"addBookMutation"}))(q),L=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={selected:null},a.onBookClicked=a.onBookClicked.bind(Object(p.a)(a)),a}return Object(u.a)(n,[{key:"onBookClicked",value:function(e){this.setState({selected:e})}},{key:"displayBooks",value:function(){var e=this,t=this.props.data;return t.loading?r.a.createElement("p",null,"Loading books..."):t.books?t.books.map((function(t){return r.a.createElement("li",{key:t.id,onClick:function(n){return e.onBookClicked(t.id)}},t.name)})):void 0}},{key:"render",value:function(){return r.a.createElement("div",{id:"main"},r.a.createElement("h1",null,"My Reading List."),r.a.createElement("ul",{id:"book-list"},this.displayBooks()),r.a.createElement(F,{bookId:this.state.selected}),r.a.createElement(x,null))}}]),n}(a.Component),J=Object(E.a)(H)(L),P=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).bookDeleteHandler=function(t){e.props.removeBookMutation({variables:{id:t},refetchQueries:[{query:B}]})},e.authorDeleteHandler=function(t){window.confirm("Are you sure you want to delete ".concat(t.name," and all books by this author?"))&&(t.books.forEach((function(t){return e.bookDeleteHandler(t.id)})),e.props.removeAuthorMutation({variables:{id:t.id},refetchQueries:[{query:B}]}))},e.displayAuthors=function(){var t=e.props.getAdminAuthorsQuery,n=t.authors,a=t.error;return t.loading?r.a.createElement("p",null,"loading authors..."):a?r.a.createElement("p",null,"Error: ",a.message):n?r.a.createElement("ul",{className:"authors-list container"},n.map((function(t){return r.a.createElement("div",{className:"row author",key:t.id},r.a.createElement("div",{className:"col-6"},r.a.createElement("p",null,t.name),r.a.createElement("p",{className:"delete-author-btn",onClick:function(){return e.authorDeleteHandler(t)}},"delete author")),r.a.createElement("div",{className:"col-6"},r.a.createElement("ul",null,t.books.map((function(t){return r.a.createElement("li",{key:t.id},t.name," ",r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true",onClick:function(){return e.bookDeleteHandler(t.id)}}))})))))}))):void 0},e}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{id:"admin"},r.a.createElement("h2",null,"Admin Page."),this.displayAuthors())}}]),n}(a.Component),G=S()(Object(E.a)(B,{name:"getAdminAuthorsQuery"}),Object(E.a)(H,{name:"getBooksQuery"}),Object(E.a)(N,{name:"removeBookMutation"}),Object(E.a)($,{name:"removeAuthorMutation"}))(P),R=function(){return r.a.createElement("nav",{className:"navbar container"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(b.b,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(b.b,{to:"/admin"},"Admin"))))},z=n(33),K=function(){return r.a.createElement(z.b,{query:H},(function(e){var t=e.loading,n=e.error,a=e.data;return t?r.a.createElement("p",null,"Loading..."):n?r.a.createElement("p",null,"Error: ",n.message):r.a.createElement("div",null,r.a.createElement("ul",{id:"book-list-new"},a.books.map((function(e){return r.a.createElement("li",{key:e.id},e.name)}))))}))},T=new s.a({uri:"http://localhost:4000/graphql"}),U=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement(d.b,{client:T},r.a.createElement(b.a,null,r.a.createElement("div",null,r.a.createElement(R,null),r.a.createElement(h.c,null,r.a.createElement(h.a,{path:"/",exact:!0,component:J}),r.a.createElement(h.a,{path:"/admin",component:G}),r.a.createElement(h.a,{path:"/list-new",component:K}),r.a.createElement(h.a,{render:function(){return r.a.createElement("h4",null,"Page not found.")}})))))}}]),n}(a.Component);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.12e60c86.chunk.js.map